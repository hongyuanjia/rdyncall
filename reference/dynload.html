<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Alternative framework for loading of shared libraries and resolving of symbols.
The framework offers automatic unload management of shared libraries and
provides a direct interface to the dynamic linker of the OS."><title>Loading of shared libraries and resolving of symbols (Alternative Framework) — dynload • rdyncall</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loading of shared libraries and resolving of symbols (Alternative Framework) — dynload"><meta property="og:description" content="Alternative framework for loading of shared libraries and resolving of symbols.
The framework offers automatic unload management of shared libraries and
provides a direct interface to the dynamic linker of the OS."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rdyncall</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Loading of shared libraries and resolving of symbols (Alternative Framework)</h1>
      
      <div class="d-none name"><code>dynload.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Alternative framework for loading of shared libraries and resolving of symbols.
The framework offers <em>automatic unload management</em> of shared libraries and
provides a direct interface to the dynamic linker of the OS.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dynload</span><span class="op">(</span><span class="va">libname</span>, auto.unload<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">dynsym</span><span class="op">(</span><span class="va">libhandle</span>, <span class="va">symname</span>, protect.lib<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">dynunload</span><span class="op">(</span><span class="va">libhandle</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>libname</dt>
<dd><p>character string giving the pathname to a shared library in OS-specific notation.</p></dd>

  <dt>libhandle</dt>
<dd><p>external pointer representing a handle to an opened library.</p></dd>

  <dt>symname</dt>
<dd><p>character string specifying a symbolic name to be resolved.</p></dd>

  <dt>auto.unload</dt>
<dd><p>logical, if <code>TRUE</code> a finalizer will be registered that will automatically unload the library.</p></dd>

  <dt>protect.lib</dt>
<dd><p>logical, if <code>TRUE</code> resolved external pointers protect library handles from finalization.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dynload</code> returns an external pointer <code>libhandle</code> on success. Otherwise NULL is returned, if the library is not found or the linkage failed.</p>


<p><code>dynsym</code> returns an external pointer <code>address</code> on success. Otherwise NULL is returned, if the address was invalid or the symbol has not been found.</p>


<p><code>dynunload</code> always returns <code>NULL</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>dynload</code> loads a shared library into the current R process using the OS-specific dynamic linker interface. 
The <code>libname</code> is passed <em>as-is</em> directly to the dynamic linker and thus is given in OS-specific notation - see below for details. 
On success, a handle to the library represented as an external pointer R objects is returned, otherwise <code>NULL</code>. 
If <code>auto.unload</code> is <code>TRUE</code>, a finalizer function is registered that will unload the library on garbage collection via <code>dynunload</code>.</p>
<p><code>dynsym</code> looks up symbol names in loaded libraries and resolves them to memory addresses returned as external pointer R objects.
Otherwise <code>NULL</code> is returned. 
If <code>protect.lib</code> is <code>TRUE</code>, the library handle is <em>protected</em> by resolved address external pointers from unloading.</p>
<p><code>dynunload</code> explicitly unreferences the loaded library specified by <code>libhandle</code>.</p>
<p>Setting both <code>auto.unload</code> and <code>protect.lib</code> to <code>TRUE</code>, libraries remain loaded as long as resolved symbols are in use, and they get automatic unloaded 
when no resolved symbols remain.</p>
<p>Dynamic linkers usually hold an internal link count, such that a library can be opened multiple times via <code>dynload</code> 
- with a balanced number of calls to <code>dynunload</code> that decreases the link count to unload the library again.</p>
<p>Similar functionality is available via <code><a href="https://rdrr.io/r/base/dynload.html" class="external-link">dyn.load</a></code> and <code>getNativeSymbolInfo</code>, 
except that path names are filtered and no automatic unloading of libraries is supported.</p>
    </div>
    <div class="section level2">
    <h2 id="shared-library">Shared library<a class="anchor" aria-label="anchor" href="#shared-library"></a></h2>
    

<p>Shared libraries are single files that contain compiled code, data and meta-information.
The code and data can be loaded and mapped to a process at run-time once.
Operating system platforms have slightly different schemes for naming, 
searching and linking options.</p>
<table class="table table"><tr><td><strong>Platform</strong></td><td><strong>Binary format</strong></td><td><strong>File Extension</strong></td></tr><tr><td>Linux, BSD derivates and Sun Solaris</td><td>ELF format</td><td><code>so</code></td></tr><tr><td>Darwin / Apple Mac OS X</td><td>Mach-O format</td><td><code>dylib</code></td></tr><tr><td>Microsoft Windows</td><td>PE format</td><td><code>dll</code></td></tr></table></div>
    <div class="section level2">
    <h2 id="library-search-on-posix-platforms-linux-bsd-sun-solaris-">Library search on Posix platforms (Linux,BSD,Sun Solaris)<a class="anchor" aria-label="anchor" href="#library-search-on-posix-platforms-linux-bsd-sun-solaris-"></a></h2>
      

<p>The following text is taken from the Linux <code>dlopen</code> manual page:</p>
<p>These search rules will only be applied to path names that do not contain an embedded '/'.</p><ul><li><p>If the <code>LD_LIBRARY_PATH</code> environment variable is defined to contain a colon-separated list of
directories, then these are searched.</p></li>
<li><p>The cache file <code>/etc/ld.so.cache</code> is checked to see whether it contains an entry for filename.</p></li>
<li><p>The directories <code>/lib</code> and <code>/usr/lib</code> are searched (in that order).</p></li>
</ul><p>If the library has dependencies on other shared libraries, then these are also automatically 
loaded by the dynamic linker using the same rules.</p>
    </div>
    <div class="section level2">
    <h2 id="library-search-on-darwin-mac-os-x-platforms">Library search on Darwin (Mac OS X) platforms<a class="anchor" aria-label="anchor" href="#library-search-on-darwin-mac-os-x-platforms"></a></h2>
    

<p>The following text is taken from the Mac OS X dlopen manual page:</p>
<p><code>dlopen()</code> searches for a compatible Mach-O file in the directories specified by a set of environment
variables and the process's current working directory.  When set, the environment variables must contain 
a colon-separated list of directory paths, which can be absolute or relative to the current working
directory. The environment variables are $LD_LIBRARY_PATH, $DYLD_LIBRARY_PATH, and $DYLD_FALLBACK_LIBRARY_PATH. 
The first two variables have no default value. The default value of $DYLD_FALLBACK_LIBRARY_PATH
is $HOME/lib;/usr/local/lib;/usr/lib.  <code>dlopen()</code> searches the directories specified in
the environment variables in the order they are listed.</p>
<p>When path doesn't contain a slash character (i.e. it is just a leaf name), <code>dlopen()</code> searches the following 
until it finds a compatible Mach-O file: $LD_LIBRARY_PATH, $DYLD_LIBRARY_PATH,
current working directory, $DYLD_FALLBACK_LIBRARY_PATH.</p>
<p>When path contains a slash (i.e. a full path or a partial path) <code>dlopen()</code> searches the following the
following until it finds a compatible Mach-O file: $DYLD_LIBRARY_PATH (with leaf name from path ), current
working directory (for partial paths), $DYLD_FALLBACK_LIBRARY_PATH (with leaf name from path ).</p>
    </div>
    <div class="section level2">
    <h2 id="library-search-on-microsoft-windows-platforms">Library search on Microsoft Windows platforms<a class="anchor" aria-label="anchor" href="#library-search-on-microsoft-windows-platforms"></a></h2>
    

<p>The following text is taken from the Window SDK Documentation:</p>
<p>If no file name extension is specified [...], the default library extension 
<code>.dll</code> is appended. However, the file name string can include a trailing point character (.) to 
indicate that the [shared library] module name has no extension. When no path is specified, the function searches 
for loaded modules whose base name matches the base name of the module to be loaded. 
If the name matches, the load succeeds. Otherwise, the function searches for the file in the 
following sequence:</p>
<ul><li><p>The directory from which the application loaded.</p></li>
<li><p>The current directory.</p></li>
<li><p>The system directory. Use the GetSystemDirectory Win32 API function to get the path of this directory.</p></li>
<li><p>The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched. Windows Me/98/95:  This directory does not exist.</p></li>
<li><p>The Windows directory. Use the GetWindowsDirectory Win32 API function to get the path of this directory.</p></li>
<li><p>The directories that are listed in the PATH environment variable.</p></li>
</ul><p>Windows Server 2003, Windows XP SP1:  The default value of</p><div class="sourceCode"><pre><code>HKLM\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</code></pre></div><p>is 1 (current directory is searched after the system and Windows directories).</p>
<p>Windows XP:  If</p><div class="sourceCode"><pre><code>HKLM\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</code></pre></div><p>is 1, the current directory is searched after the system and Windows directories, but before the directories in the PATH environment variable. The default value is 0 (current directory is searched before the system and Windows directories).</p>

<p>The first directory searched is the one directory containing the image file used to create the calling process. Doing this allows private dynamic-link library (DLL) files associated with a process to be found without adding the process's installed directory to the PATH environment variable.</p>
<p>The search path can be altered using the <code>SetDllDirectory</code> function. This solution is recommended instead of using <code>SetCurrentDirectory</code> or hard-coding the full path to the DLL.</p>
<p>If a path is specified and there is a redirection file for the application, the function searches for the module in the application's directory. If the module exists in the application's directory, the LoadLibrary function ignores the specified path and loads the module from the application's directory. If the module does not exist in the application's directory, LoadLibrary loads the module from the specified directory. For more information, see Dynamic Link Library Redirection from the Windows SDK Documentation.</p>
    </div>
    <div class="section level2">
    <h2 id="portability">Portability<a class="anchor" aria-label="anchor" href="#portability"></a></h2>
    <p>The implementation is based on the <em>dynload</em> library (part of the DynCall project) which has been ported
to all major R platforms (ELF (Linux,BSD,Solaris), Mach-O (Mac OS X) and Portable Executable (Win32/64)).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>This facility is used by <code><a href="dynfind.html">dynfind</a></code> and <code><a href="dynbind.html">dynbind</a></code>.
  Similar functionality is available from <code><a href="https://rdrr.io/r/base/dynload.html" class="external-link">dyn.load</a></code> and <code><a href="https://rdrr.io/r/base/getNativeSymbolInfo.html" class="external-link">getNativeSymbolInfo</a></code>.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Hongyuan Jia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

