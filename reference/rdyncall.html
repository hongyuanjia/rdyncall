<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The package provides a cross-platform framework for dynamic binding of
  C libraries using a flexible Foreign Function Interface (FFI).
  The FFI supports almost all fundamental C types, multiple calling conventions,
  symbolic access to foreign C struct/union data types and wrapping of R functions
  as C callback function pointers.
  Dynamic bindings to shared C libraries are data-driven by cross-platform binding specification
  using a compact plain text format ; an initial repository of bindings to a couple of
  common C libraries (OpenGL, SDL, Expat, glew, CUDA, OpenCL, ODE, R) comes with the package.
  The package includes a variety of technology demos and OS-specific notes for installation of shared libraries."><title>Improved Foreign Function Interface (FFI) and Dynamic Bindings to C Libraries (e.g. OpenGL) — rdyncall • rdyncall</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Improved Foreign Function Interface (FFI) and Dynamic Bindings to C Libraries (e.g. OpenGL) — rdyncall"><meta property="og:description" content="The package provides a cross-platform framework for dynamic binding of
  C libraries using a flexible Foreign Function Interface (FFI).
  The FFI supports almost all fundamental C types, multiple calling conventions,
  symbolic access to foreign C struct/union data types and wrapping of R functions
  as C callback function pointers.
  Dynamic bindings to shared C libraries are data-driven by cross-platform binding specification
  using a compact plain text format ; an initial repository of bindings to a couple of
  common C libraries (OpenGL, SDL, Expat, glew, CUDA, OpenCL, ODE, R) comes with the package.
  The package includes a variety of technology demos and OS-specific notes for installation of shared libraries."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rdyncall</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Improved Foreign Function Interface (FFI) and Dynamic Bindings to C Libraries (e.g. OpenGL)</h1>
      
      <div class="d-none name"><code>rdyncall.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The package provides a cross-platform framework for dynamic binding of
  C libraries using a flexible Foreign Function Interface (FFI).
  The FFI supports almost all fundamental C types, multiple calling conventions,
  symbolic access to foreign C struct/union data types and wrapping of R functions
  as C callback function pointers.
  Dynamic bindings to shared C libraries are data-driven by cross-platform binding specification
  using a compact plain text format ; an initial repository of bindings to a couple of
  common C libraries (OpenGL, SDL, Expat, glew, CUDA, OpenCL, ODE, R) comes with the package.
  The package includes a variety of technology demos and OS-specific notes for installation of shared libraries.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><span class="pkg">rdyncall</span> offers a stack of interoperability technologies for working
with foreign compiled languages using cross-platform portable abstraction
methods.</p>
<p>For R application development, the package facilitates direct access from R
to the C Application Programming Interface (API) of common libraries.
This enables a new style of development: R applications can use
low-level services of portable C libraries.
System-level code can be implemented in R without leaving the language.
C APIs can be explored from within the R interpreter.
Moving the R code from one platform to the other does not involve
recompilation.
Ofcourse, the run-time libraries need to be installed using a standard
procedure of the target Operating-System Distribution.
See <a href="rdyncall-demos.html">rdyncall-demos</a> for details on this.</p>
<p>For R core development and research, the package provides an improved Foreign
Function Interface (FFI) that can be used to call arbitrary
foreign precompiled C code without the need for additional
compilation of wrapper code. The back-end library is extendable with new
calling conventions (such as Fortran,Pascal,COM,etc.. - which has not been
the focus as of this release, but might be supported officially in the near
futurue).
Basic type-safety checks for argument passing and framework support for
working with foreign C data types such as pointers, arrays, structs and
wrapping of R functions into first-level C callback function pointers
round up this framework.</p>
    </div>
    <div class="section level2">
    <h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
    
<ul><li><p>Flexible FFI with support for almost all C types, type-safety checks and multiple calling conventions. See <code>dyncall</code>.</p></li>
<li><p>Loading of shared libraries with <em>automatic unload management</em> and using direct access to OS linker. See <code>dynload</code>.</p></li>
<li><p>Cross-platform naming and loading of shared libraries. See <code><a href="dynfind.html">dynfind</a></code>.</p></li>
<li><p>Binding C library functions via thin call wrappers. See <code><a href="dynbind.html">dynbind</a></code>.</p></li>
<li><p>Handling of foreign C pointer, array and struct/union data types. See <code><a href="packing.html">packing</a></code> and <code><a href="struct.html">struct</a></code>.</p></li>
<li><p>Dynamic wrapping of R functions as C function pointers to be used in C callbacks. See <code><a href="dyncallback.html">ccallback</a></code>.</p></li>
<li><p>Dynamic bindings to standard and common C libraries and APIs (functions, variables, macro constants, enums, struct and union types). See <code><a href="dynport.html">dynport</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a></h2>
    <p>Several demos ranging from simple FFI calls to the C standard math library up to more complex 3D OpenGL/SDL Applications are available.
See <code>demos(package="rdyncall")</code> for an overview.
Some demos require shared C libraries to be installed in the system. Please read <a href="rdyncall-demos.html">rdyncall-demos</a> for details.</p>
    </div>
    <div class="section level2">
    <h2 id="supported-platforms">Supported Platforms<a class="anchor" aria-label="anchor" href="#supported-platforms"></a></h2>
    <p>The low-level implementation is mainly based on libraries from the DynCall
Project (<a href="https://dyncall.org" class="external-link">https://dyncall.org</a>). The library suite is distributed
as part of the package source tree.</p>
<p>The dyncall and dyncallback libraries implement generic low-level services
with the help of a small amount of hand-written assembly code and
careful modeling of the target machine's calling sequence
for each platform to support.</p>
<p>As of version 0.6, the following processor architectures are supported:</p>
<ul><li><p>Intel i386 32-bit and AMD 64-bit Platforms</p></li>
<li><p>ARM 32-bit (OABI, EABI and ARMHF ABI with support for Thumb)</p></li>
<li><p>PowerPC 32-bit (support for callbacks not implemented for Linux/BSD)</p></li>
<li><p>MIPS 32- and 64-bit (support for callbacks not yet implemented)</p></li>
<li><p>SPARC 32- and 64-bit (support for callbacks not yet implemented)</p></li>
</ul><p>The DynCall libraries are tested on Linux, Mac OS X, Windows, BSD derivates
and more exotic platforms such as game consoles and Plan9.
Please see the details on portability for dyncall, <a href="dyncallback.html">dyncallback</a> and dynload
and the official DynCall manual for full details of the back-end.
The R Package has been tested on several major R platforms.
The following gives a list of comments on platforms about the status of this package.</p>
<table class="table table"><tr><td></td></tr><tr><td>Linux Debian 4/ppc32 , R-2.4.0 : ok, but no callbacks.</td></tr><tr><td>Linux Debian 5/arm   , R-2.7.0 : ok, SDL not tested.</td></tr><tr><td>Linux Debian 6/x86   , R-2.12.2: ok.</td></tr><tr><td>Linux Debian 6/x64   , R-2.12.2: ok.</td></tr><tr><td>Linux Ubuntu 10/armv7, R-2.14  : ok.</td></tr><tr><td>Linux Fedora 14/x86            : ok.</td></tr><tr><td>Linux Ubuntu 12/i386 , R-2.15.1: ok.</td></tr><tr><td>Mac OS X 10.4/ppc    , R-2.10.0: ok.</td></tr><tr><td>Mac OS X 10.6/x86    , R-2.12.2: ok.</td></tr><tr><td>Mac OS X 10.6/x64    , R-2.12.2: ok.</td></tr><tr><td>Mac OS X 10.7/x64    , R-2.15.1: ok.</td></tr><tr><td>NetBSD 5.0/x86                 : ok.</td></tr><tr><td>NetBSD 5.1/x64                 : ok.</td></tr><tr><td>OpenBSD 4.8/x64      , R-2.7.0 : SDL failed.</td></tr><tr><td>Windows XP/x86       , R-2.12.2: ok.</td></tr><tr><td>Windows  7/x86       , R-2.12.2: ok.</td></tr><tr><td>Windows  7/x64       , R-2.12.2: ok, use correct 64-bit SDL DLL, SDL extension not tested - see <a href="rdyncall-demos.html">rdyncall-demos</a>)</td></tr><tr><td>FreeBSD 8.2/x86                : build ok, no tests made for X11.</td></tr><tr><td></td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Adler, D. (2012) “Foreign Library Interface”, <em>The R Journal</em>, <b>4(1)</b>, 30--40, June 2012.
  <a href="https://journal.r-project.org/articles/RJ-2012-004/" class="external-link">https://journal.r-project.org/articles/RJ-2012-004/</a></p>
<p>Adler, D., Philipp, T. (2008) <em>DynCall Project</em>.
  <a href="https://dyncall.org" class="external-link">https://dyncall.org</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># multimedia example</span></span></span>
<span class="r-in"><span><span class="co"># load dynports for OpenGL, Simple DirectMedia library</span></span></span>
<span class="r-in"><span><span class="co"># globals:</span></span></span>
<span class="r-in"><span><span class="va">surface</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="co"># init SDL and OpenGL</span></span></span>
<span class="r-in"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dynport.html">dynport</a></span><span class="op">(</span><span class="va">SDL</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dynport.html">dynport</a></span><span class="op">(</span><span class="va">GL</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span> <span class="fu">SDL_Init</span><span class="op">(</span><span class="va">SDL_INIT_VIDEO</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"SDL_Init failed"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">surface</span> <span class="op">&lt;&lt;-</span> <span class="fu">SDL_SetVideoMode</span><span class="op">(</span><span class="fl">320</span>,<span class="fl">240</span>,<span class="fl">32</span>,<span class="va">SDL_DOUBLEBUF</span><span class="op">+</span><span class="va">SDL_OPENGL</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"surface dimension:"</span>, <span class="va">surface</span><span class="op">$</span><span class="va">w</span>, <span class="st">"x"</span>,<span class="va">surface</span><span class="op">$</span><span class="va">h</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># draw blue screen</span></span></span>
<span class="r-in"><span><span class="va">updateSurface</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">glClearColor</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">t</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">glClear</span><span class="op">(</span><span class="va">GL_COLOR_BUFFER_BIT</span><span class="op">+</span><span class="va">GL_DEPTH_BUFFER_BIT</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">SDL_GL_SwapBuffers</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># wait till close</span></span></span>
<span class="r-in"><span><span class="va">mainloop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">quit</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="va">evt</span> <span class="op">&lt;-</span> <span class="fu"><a href="struct.html">cdata</a></span><span class="op">(</span><span class="va">SDL_Event</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">SDL_GetTicks</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="kw">while</span><span class="op">(</span><span class="op">!</span><span class="va">quit</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">updateSurface</span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">while</span><span class="op">(</span><span class="fu">SDL_PollEvent</span><span class="op">(</span><span class="va">evt</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="kw">if</span> <span class="op">(</span> <span class="va">evt</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="va">SDL_QUIT</span> <span class="op">)</span> <span class="va">quit</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">now</span> <span class="op">&lt;-</span> <span class="fu">SDL_GetTicks</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>    <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">now</span> <span class="op">-</span> <span class="va">base</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mainloop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Hongyuan Jia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

